
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Razor Sharp Design</title>
  <meta name="author" content="Justin Reidy">

  
  <meta name="description" content="January&rsquo;s been a long month; not in a bad sense, just sort of interminable. Looking through my links collection in notational velocity today, I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://rzrsharp.net/blog/page/2/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Razor Sharp Design" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>

<script type="text/javascript" src="http://use.typekit.com/eqy0aif.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-5761922-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:rzrsharp.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2012/01/30/welcome-to-2012.html">Welcome to 2012</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2012-01-30T16:31:00-08:00" pubdate data-updated="true">Jan 30<span>th</span>, 2012</time>
        
         | <a href="/2012/01/30/welcome-to-2012.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>January&rsquo;s been a long month; not in a <em>bad</em> sense, just sort of interminable. Looking through my links collection in notational velocity today, I found a good twenty plus from the last six weeks. I&rsquo;ve culled them down a bit to the true standouts:</p>

<ul>
<li><p>An Object is not (Always) a Hash &mdash; Great post from Guillermo Rauch about <a href="http://www.devthought.com/2012/01/18/an-object-is-not-a-hash/">the perils of using Javascript Objects as Hashes</a>. Definitely some tricky gotchas here that you may not have thought about.</p></li>
<li><p>Hot Node Reloading &mdash; Also from Guillermo, a solution to the annoying problem of continuously restarting your node app during development: <a href="http://www.devthought.com/2012/01/29/staying-up-with-node-js/">Staying Up with Node.JS</a></p></li>
<li><p>Shedding Light on SPDY &mdash; If you haven&rsquo;t been hearing a great deal about SPDY lately, you will be soon. SPDY, if you couldn&rsquo;t tell from the name, serves as a next-generation protocol to speed up web communication. Nodejitsu posts <a href="http://blog.nodejitsu.com/what-is-node-spdy">a helpful introduction to SPDY</a>.</p></li>
<li><p>Improving your Git Logs &mdash; Git log, out of the box, is so wordy that it proves fairly worthless. Check out Oli Studholme&rsquo;s <a href="http://oli.jp/2012/git-powerup/">aliases for taming the git log beast</a>.</p></li>
<li><p>Hack Learning &mdash; One of the key lessons I&rsquo;ve learned as a developer is that getting good at something requires hours, and hours, and hours, and <strong>hours</strong> of work, and many of these hours will be exhausting displays of ignorance which you&rsquo;ll want to quickly forget. The good news is that you can pick up nearly any skill with enough effort and time. Jack Kinsella provides a hack for cutting back on how many hours separate &ldquo;terrible newb&rdquo; from &ldquo;fairly competent practitioner&rdquo;. His <a href="http://www.jackkinsella.ie/2011/12/05/janki-method.html">Janki Method</a> may <em>sound</em> like a get rich quick scheme, but it&rsquo;s really just a simple approach to improving your effiency at learning. Maybe you can cut those 10,000 hours of practice to a more managable&hellip; 6,000.</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2012/01/12/a-year-in-coffee.html">A Year in Coffee</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2012-01-12T13:48:00-08:00" pubdate data-updated="true">Jan 12<span>th</span>, 2012</time>
        
         | <a href="/2012/01/12/a-year-in-coffee.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last year was the first that I dove deeply into the coffee world, turning what
was previously an interest into a full-blown passion. While I had previously
ground beans at home and brewed in a french press, I decided sometime in 2010
that I wanted to learn more. Going into 2011, I started brewing with an
aeropress and chemex, upgraded my grinder to a Baratza Virtuoso, and furthered my coffee knowledge by reading <a href="http://www.amazon.com/God-Cup-Obsessive-Perfect-Coffee/dp/0470173580">God in a Cup</a> and <a href="http://www.amazon.com/Uncommon-Grounds-History-Coffee-Transformed/dp/0465054676">Uncommon Grounds</a>. I began taking notes on my home brews and asking questions at coffee bars. And I bought <em>lots</em> of coffee. Lots and lots and lots of coffee.</p>

<p><img src="http://s3.cheeryobservations.com/coffee2011_redone.jpg" alt="Lots of coffee" /></p>

<p>Meaghin <a href="http://www.cheeryobservations.com/photography/2011-coffee-more-coffee-than-weeks-in-the-year/">has more pictures and a full rundown of our 2011 coffee purchases</a>, but I wanted to highlight a few bags in particular.</p>

<p><img src="http://s3.cheeryobservations.com/coffee2011_15.jpg" alt="Coava and Wrecking Ball" /></p>

<p><a href="http://www.wreckingballcoffee.com/">Wrecking Ball Coffee Roasters</a> is a new enterprise from Trish Rothgeb and Nick
Cho; I was lucky enough to get one of the first bags they shipped this year.
Their coffee presented a perfect example of what makes me love Ethiopian
coffees, offering a pleasantly light body without being too acidic. I like to
compare good east African coffees to pinot noir &ndash; almost all have a juiciness
to them, but the best are balanced with strong bass notes. I loved
Wrecking Ball&rsquo;s fully biodegradable package. But beyond the coffee itself,
I was happy to order from Wrecking Ball because of Nick Cho. Cho used to run
the amazing Murky Coffee in Arlington, VA, which I visited very frequently when
I lived in the DC area. Ironically, I didn&rsquo;t drink much coffee at the time, having
been exposed to some swill in college. But Murky is what enticed me to learn
more: the intoxicating smell of freshly ground Counter Culture coffee, the
precise movements of the baristas as they brewed espressos, the clear passion
of everyone involved. Drinking the Wrecking Ball made me feel as if I were
making up for the coffee I never enjoyed at Murky.</p>

<p>If Murky induced my coffee passion, <a href="http://coavacoffee.com">Coava</a> revealed the heights to which this
passion could be taken. I drank Coava&rsquo;s David Mancia from Honduras early in the
year; later, I would visit Coava&rsquo;s Portland shop in person. The David Mancia
completely blew my mind. Even in my early days of home-brewing, I couldn&rsquo;t
screw this coffee up: chocalate, berries, an amazing finish, thick and juicy
and succulent. I couldn&rsquo;t wait to see how Coava&rsquo;s shop measured up to the
coffee they roasted, and found one of my favorite coffee shops in the country.
I can&rsquo;t wait to go back.</p>

<p><img src="http://s3.cheeryobservations.com/coffee2011_21.jpg" alt="Coffee Collective" /></p>

<p>One of the highlights of 2011 was my trip to Copenhagen with Meaghin. Before the
trip, I greatly anticipated experiencing Danish culture, perhaps
most intrigued by their coffee culture. Almost everywhere we bought coffee in
Copenhagen, we felt pleased with the product, but <a href="http://thecoffeecollective.dk/">Coffee Collective</a> is an
entity unto itself. We visited their new location in Torvehallerne, a glorious
outdoor food market, a few times, trying various coffee drinks on each visit;
the Kieni from Nyeri, Kenya proved particularly delicious.</p>

<p>Two weeks into 2012 and as many bags brewed; I&rsquo;m currently finishing up a great
roast from <a href="http://www.cafegrumpy.com">Cafe Grumpy</a>, from Finca La Coqueta in
Columbia. I look forward to finding out what my favorites will be <em>this</em> year.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/12/05/better-support-for-helpers-in-vows-bdd.html">Better Support for Helpers in Vows-bdd</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-12-05T15:31:00-08:00" pubdate data-updated="true">Dec 5<span>th</span>, 2011</time>
        
         | <a href="/2011/12/05/better-support-for-helpers-in-vows-bdd.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This last week has been a particularly busy one, so I&rsquo;ve been delayed in blogging,
but I released v0.2 of vows-bdd to NPM a week ago. There&rsquo;s two changes of note.
The first is proper documentation for the library: you can see the docco documentation
<a href="http://rzrsharp.net/vows-bdd">here</a>. If you&rsquo;re new to vows-bdd, or just want to learn
more about how it&rsquo;s working, the docs should provide all the answers you&rsquo;re looking
for.</p>

<p>The more important change relates to the testing syntax. In some conversations I had
online with <a href="http://graemef.com/">Graeme Foster</a>, I realized that the vows-bdd syntax
left some room for improvement. Specifically, the syntax introduced a potential for
redundancy when creating labels for integration tests. While named functions could
be used for test statements that were repeated, there wasn&rsquo;t an easy to way to handle
repeated labels.</p>

<p>In order to make the use of test helpers even easier with vows-bdd, I have adjusted
the <code>given/when/then/and</code> syntax to allow for array arguments <em>in addition to</em> the
previous arguments of <code>label,test_function</code>. It&rsquo;s easiest to demonstrate the change with
an example. One area of code that frequently is repeated is login code in integration tests.
Here&rsquo;s how I had my tests setup with vows-bdd before:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="c1"># a test snippet</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">given</span> <span class="s">&quot;I am an admin user&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="vi">@user = </span><span class="nx">Model</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">create</span> <span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nv">role: </span><span class="s">&#39;admin&#39;</span><span class="p">}</span>
</span><span class='line'>    <span class="nx">@callback</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I go to login&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">zombie</span><span class="p">.</span><span class="nx">visit</span> <span class="nx">Server</span><span class="p">.</span><span class="nx">path_for</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">),</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I click login&quot;</span><span class="p">,</span> <span class="nf">(browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@user</span><span class="p">.</span><span class="nx">email</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@user</span><span class="p">.</span><span class="nx">password</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Login&quot;</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span> <span class="s">&quot;I should be on the admin index&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">shouldBeOn</span> <span class="nx">browser</span><span class="p">,</span> <span class="s">&quot;/admin&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># snippet from another test</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">given</span> <span class="s">&quot;I am an admin user&quot;</span><span class="p">,</span> <span class="o">&gt;</span>
</span><span class='line'>    <span class="vi">@password = </span><span class="s">&quot;foo&quot;</span>
</span><span class='line'>    <span class="vi">@user = </span><span class="nx">Model</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">build</span><span class="p">(</span> <span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="nv">password: </span><span class="nx">@password</span><span class="p">,</span> <span class="nv">passwordConf: </span><span class="nx">@password</span><span class="p">,</span> <span class="nv">role: </span><span class="s">&quot;admin&quot;</span> <span class="p">)</span>
</span><span class='line'>    <span class="nx">@user</span><span class="p">.</span><span class="nx">save</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I am logged in&quot;</span><span class="p">,</span> <span class="o">&gt;</span>
</span><span class='line'>    <span class="nv">user = </span><span class="nx">@user</span>
</span><span class='line'>    <span class="nv">cb = </span><span class="nx">@callback</span>
</span><span class='line'>    <span class="nv">pw = </span><span class="nx">@password</span>
</span><span class='line'>    <span class="nx">zombie</span><span class="p">.</span><span class="nx">visit</span> <span class="nx">Server</span><span class="p">.</span><span class="nx">path_for</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">),</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="nx">browser</span><span class="p">,</span><span class="nx">status</span><span class="p">)</span> <span class="o">&gt;</span>
</span><span class='line'>      <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span> <span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span>
</span><span class='line'>      <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span> <span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="nx">pw</span>
</span><span class='line'>      <span class="nx">browser</span><span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Login&quot;</span><span class="p">,</span> <span class="nx">cb</span>
</span><span class='line'>    <span class="k">return</span>
</span></code></pre></td></tr></table></div></figure>


<p>Even with the previous syntax, this code could be improved by creating a named <code>login</code>
function that handles the duplicated code. And you could add a property to that function
that provides a label. But I felt that the vows-bdd syntax should be improved to make
this code repetition even easier. So the new <code>[label,function]</code> syntax looks like
this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="c1"># first test</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">scenario</span><span class="p">(</span><span class="s">&quot;&#39;/admin&#39; is accessible to logged in admin users&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">login_as</span> <span class="s">&quot;an admin&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span> <span class="s">&quot;I should be on the admin index&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">shouldBeOn</span> <span class="nx">browser</span><span class="p">,</span> <span class="s">&quot;/admin&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># other test</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">scenario</span><span class="p">(</span><span class="s">&quot;Logging Out&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">given</span><span class="p">(</span><span class="nx">I</span><span class="p">.</span><span class="nx">login_as</span> <span class="s">&quot;an admin&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I click logout&quot;</span><span class="p">,</span> <span class="nf">(browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">browser</span><span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Logout&quot;</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span> <span class="s">&quot;I should be redirected to the login page&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="c1">#continues</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>login_as</code> function is included in a helper file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">exports.login_as = </span><span class="nf">(type_of_user) -&gt;</span>
</span><span class='line'>  <span class="nv">label = </span><span class="s">&quot;I login as </span><span class="si">#{</span><span class="nx">type_of_user</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'>  <span class="nv">fixture = </span><span class="p">()</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nv">cb = </span><span class="nx">@callback</span>
</span><span class='line'>    <span class="vi">@user = </span><span class="nv">user = </span><span class="nx">Model</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">create</span> <span class="nx">type_of_user</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/a[n]? (\w+)/</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>    <span class="nx">zombie</span><span class="p">.</span><span class="nx">visit</span> <span class="nx">Server</span><span class="p">.</span><span class="nx">path_for</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">),</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>      <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class='line'>             <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span class='line'>             <span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Login&quot;</span><span class="p">,</span> <span class="nx">cb</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span><span class="nx">label</span><span class="p">,</span><span class="nx">fixture</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that the function returns an array of arguments to be supplied to the vows-bdd
method. Also note that the fixture method is using <code>this</code> &mdash; which will point to the
vows <code>context</code> when the test is evaluated &mdash; and that the fixture returns <code>undefined</code>
to indicate to vows that the test should be performed asynchronously.</p>

<p>I think this new syntax works really perfectly for integration tests; it goes a long
way to supporting declarative testing style.</p>

<p>As always, please let me know if you run into any problems with the library or
have any suggestions!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/11/21/thanksgiving-week-links.html">Thanksgiving Week Links</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-11-21T16:17:00-08:00" pubdate data-updated="true">Nov 21<span>st</span>, 2011</time>
        
         | <a href="/2011/11/21/thanksgiving-week-links.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve never been a fan of links posts &ndash; they always feel like &ldquo;clips
episodes&rdquo; from sitcoms to me &ndash; but I&rsquo;ve realized that they can be pretty helpful, if
they&rsquo;re well curated. I&rsquo;m going to be experimenting with the &ldquo;well curated&rdquo; sort
of links posts. Please feel free to yell at me on twitter
if these get boring.</p>

<ul>
<li><p>A scaffold for your node &ndash; <a href="https://github.com/spiceapps/scaffoldit">scaffoldit</a>
is a customizable scaffold generator for your nodejs projects. I don&rsquo;t think that there&rsquo;s
<em>that</em> much boilerplate for express based apps, but this library is still pretty helpful for
getting my tests and basic app configured quickly.</p></li>
<li><p>Basic metaprogramming in Ruby &ndash; If you&rsquo;re new to Ruby and are confused by some of
the metaprogramming enabled by methods like <code>repond_to?</code> and <code>method_missing</code>, check
out <a href="http://intridea.com/posts/dry-magic-methods">this helpful post</a> from the Intridea
blog.</p></li>
<li><p>Build first, talk later &ndash; Spencer Fry, founder of Carbonmade, offers some fine advice
to <a href="http://spencerfry.com/show-dont-tell">show don&rsquo;t tell</a> &ndash; a prototype is worth
ten thousand words. I particularly like his observation that &ldquo;The best thinking
about your product will come from actually building it.&rdquo;</p></li>
<li><p>Productivity geekery &ndash; <a href="http://brettterpstra.com/app-review-dropzone/">Brett Terpstra reviews</a>
the mother-of-all-menubar-apps, Dropzone. I haven&rsquo;t bought it yet myself, but I&rsquo;m pretty close to pulling the trigger.</p></li>
<li><p>Writing your readme &ndash; Awhile back, nodejitsu offered
<a href="http://blog.nodejitsu.com/package-dependencies-done-right">some solid advice</a>
on setting up your node project&rsquo;s <code>package.json</code> file.
Now they&rsquo;re back with some more great advice, but this time it&rsquo;s more universal:
<a href="http://blog.nodejitsu.com/how-to-write-a-readme">how to write a <em>helpful</em> readme for your next open source project</a>.</p></li>
<li><p>After reading Umair Haque&rsquo;s excellent <a href="http://www.amazon.com/New-Capitalist-Manifesto-Building-Disruptively/dp/1422158586">New Capitalist Manifesto</a>, I&rsquo;ve been thinking a great deal about the values
of sustainability in business and how value cycles drastically improve upon value chains.
I was excited to see <a href="http://www.avc.com/a_vc/2011/11/sustainability.html">Fred Wilson explore the same issues on his blog</a>:</p></li>
</ul>


<blockquote><p>sustainability is all about figuring out how to be in business forever. It is about business models that are win/win and lead to happy long term customer and supplier relationships. It is about avoiding the temptation to overeach. It is about avoiding the temptation to mazimize near term profits at the expense of long term health. It is about adapting the business to changing market dynamics. It is about building a team and a culture that can survive the loss of the leader and keep going. And it is about many more things like this.</p></blockquote>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/11/10/fix-that-commit.html">Fix That Commit!</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-11-10T16:55:00-08:00" pubdate data-updated="true">Nov 10<span>th</span>, 2011</time>
        
         | <a href="/2011/11/10/fix-that-commit.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While it sometimes seems as if everyone has already switched to git (or a similar distributed
version control system), I still meet people who are only leaving subversion
behind now. A lot of git&rsquo;s idioms are impenetrable to those who are new to it, but the presence
of free resources like <a href="http://progit.org/book/">Pro Git</a> and <a href="http://gitready.com/">git ready</a> make the adjustment much easier.</p>

<p>Even though I&rsquo;ve used git for awhile, I still need to look up the best way of performing
a task every now and then. One trick that comes in handy is editing existing commits.
<code>git --amend</code> allows for adding new files or changes to a previous commit, but you can
have even more control than that &mdash; changing <em>any</em> pre-pushed commit in your history.</p>

<p>Just get the hash of the commit you want to change. With a simple <code>git rebase &lt;commit&gt;^ --interactive</code>,
you can then make any changes you want. For each file, just type <code>git add &lt;file&gt;</code>. When
you&rsquo;re done, <code>git commit --amend</code> and <code>git rebase --continue</code> will finish up your editing.</p>

<p>It&rsquo;s always useful to review and cleanup your commit history before pushing your changes
upstream or issuing a pull request. With the ability to revisit any previous commit, you
can be more comfortable in a &lsquo;commit-all-the-time&rsquo; workflow.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/11/10/cleaning-up-yours-vows.html">Cleaning Up Yours Vows</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-11-10T11:07:00-08:00" pubdate data-updated="true">Nov 10<span>th</span>, 2011</time>
        
         | <a href="/2011/11/10/cleaning-up-yours-vows.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Learning a framework as you&rsquo;re TDD-ing a project can be dangerous. But even if you
know what you&rsquo;re doing, some of the conveniences of node.js can make you a bit sloppy
with your code. Namely, the ability to pull functions from files as you need them and pass
them around makes for some interesting problems.</p>

<figure class='code'><figcaption><span>foo.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">exports</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">exports</span><span class="p">.</span><span class="nx">subtract</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">a</span><span class="o">-</span><span class="nx">b</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span>bar.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">).</span><span class="nx">add</span><span class="p">;</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span> <span class="c1">// 3</span>
</span></code></pre></td></tr></table></div></figure>


<p>If your functions are free of side effects, you&rsquo;re not exactly committing
a serious coding sin. But go beyond the simple example above &mdash; starting to pass
around whole objects, or breaking the law of demeter &mdash; and soon your code doesn&rsquo;t feel right.</p>

<p>I quickly ran into this problem with my vows tests. As I was about to merge a feature
branch to master, I reviewed my code and was a bit horrified at what I saw in my tests:</p>

<figure class='code'><figcaption><span>user_spec.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="p">{</span><span class="nx">cleanupDB</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&quot;../helpers&quot;</span>
</span><span class='line'><span class="p">{</span><span class="nx">vows</span><span class="p">,</span><span class="nx">server</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&quot;vows&quot;</span>
</span><span class='line'><span class="nv">mongoose = </span><span class="nx">require</span> <span class="s">&quot;mongoose&quot;</span>
</span><span class='line'><span class="nv">User = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span> <span class="s">&quot;User&quot;</span>
</span><span class='line'><span class="nv">assert = </span><span class="nx">require</span> <span class="s">&quot;assert&quot;</span>
</span><span class='line'><span class="nv">Sinon = </span><span class="nx">require</span> <span class="s">&quot;sinon&quot;</span>
</span><span class='line'><span class="p">{</span><span class="nx">Factory</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&quot;../helpers&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And this was just <em>one</em> of my tests. Yikes. Lots of bad things going on here:</p>

<ul>
<li>My test has a dependency on my model implementation, and not just the model itself;
if I switch the model off mongoose in the future, my test itself will need to change.</li>
<li>My test has a dependency on a particulra spying/mocking framework (Sinon)</li>
<li>There&rsquo;s a lot of confusing imports; why is <code>server</code> required off of vows?</li>
<li>Repeating requires &ndash; one for <code>cleanupDB</code> and one for <code>Factory</code>.</li>
</ul>


<p>Bad bad bad.</p>

<p>My tests needed to be refactored to deal with this madness. I realized that there was
repeated code throughout my vows tests; not only could I clean things up with some proper
encapsulation, I could DRY my vows as well.</p>

<p>One cool feature of node is that if you include an <code>index</code> file in a directory, that
file is loaded when you require the directory. So I created a new <code>spec/helpers</code> directory,
and placed an <code>index</code> file inside.</p>

<figure class='code'><figcaption><span>spec/helpers/index.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">process.env.NODE_ENV = </span><span class="s">&#39;test&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">module.exports =</span>
</span><span class='line'>  <span class="nv">Server: </span> <span class="nx">require</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/server_helpers&quot;</span>
</span><span class='line'>  <span class="nv">Test: </span> <span class="nx">require</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/test_helpers&quot;</span>
</span><span class='line'>  <span class="nv">Model: </span> <span class="nx">require</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/model_helpers&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And each of these helper files now encapsulates logic and functionality that I use
across my tests:</p>

<figure class='code'><figcaption><span>server_helpers</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">http = </span><span class="nx">require</span> <span class="s">&quot;http&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.port = port = </span><span class="mi">3003</span>
</span><span class='line'><span class="nv">server = </span><span class="p">(</span><span class="nx">require</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/../../app&quot;</span><span class="p">)</span>
</span><span class='line'><span class="nv">server.ready = </span><span class="nf">(callback) -&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">@active</span>
</span><span class='line'>    <span class="nx">process</span><span class="p">.</span><span class="nx">nextTick</span> <span class="nx">callback</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="vi">@active = </span><span class="kc">true</span>
</span><span class='line'>    <span class="nx">server</span><span class="p">.</span><span class="nx">listen</span> <span class="nx">port</span><span class="p">,</span> <span class="nf">(err,result) -&gt;</span>
</span><span class='line'>      <span class="nx">process</span><span class="p">.</span><span class="nx">nextTick</span> <span class="nx">callback</span>
</span><span class='line'>  <span class="k">return</span>
</span><span class='line'>
</span><span class='line'><span class="nx">process</span><span class="p">.</span><span class="nx">on</span> <span class="s">&quot;exit&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">@active</span> <span class="k">then</span> <span class="nx">server</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="nv">wait = </span><span class="nf">-&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">!</span><span class="nx">@active</span>
</span><span class='line'>    <span class="nx">process</span><span class="p">.</span><span class="nx">nextTick</span> <span class="nx">wait</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="k">return</span>
</span><span class='line'>
</span><span class='line'><span class="nx">server</span><span class="p">.</span><span class="nx">ready</span> <span class="nx">wait</span>
</span><span class='line'>
</span><span class='line'><span class="nv">makeRequest = </span><span class="nf">(url,params,method,callback) -&gt;</span>
</span><span class='line'>  <span class="nx">params</span> <span class="o">||=</span> <span class="s">&quot;&quot;</span>
</span><span class='line'>  <span class="nv">encoding = </span><span class="s">&#39;utf-8&#39;</span>
</span><span class='line'>  <span class="nx">server</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nv">request = </span><span class="nx">http</span><span class="p">.</span><span class="nx">request</span>
</span><span class='line'>      <span class="nv">host: </span><span class="s">&quot;127.0.0.1&quot;</span>
</span><span class='line'>      <span class="nv">port: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">port</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'>      <span class="nv">path: </span><span class="nx">url</span>
</span><span class='line'>      <span class="nv">method: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">method</span><span class="si">}</span><span class="s">&quot;</span>
</span><span class='line'>      <span class="nv">headers:</span>
</span><span class='line'>        <span class="s">&#39;content-type&#39;</span><span class="o">:</span> <span class="s">&quot;application/x-www-form-urlencoded&quot;</span>
</span><span class='line'>        <span class="s">&#39;content-length&#39;</span><span class="o">:</span> <span class="nx">params</span><span class="p">.</span><span class="nx">length</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">request</span><span class="p">.</span><span class="nx">on</span> <span class="s">&#39;response&#39;</span><span class="p">,</span> <span class="nf">(response) -&gt;</span>
</span><span class='line'>      <span class="nv">response.body = </span><span class="s">&#39;&#39;</span>
</span><span class='line'>      <span class="nx">response</span><span class="p">.</span><span class="nx">setEncoding</span> <span class="nx">encoding</span>
</span><span class='line'>      <span class="nx">response</span><span class="p">.</span><span class="nx">on</span> <span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="nf">(chunk) -&gt;</span>
</span><span class='line'>        <span class="nx">response</span><span class="p">.</span><span class="nx">body</span> <span class="o">+=</span> <span class="nx">chunk</span>
</span><span class='line'>      <span class="nx">response</span><span class="p">.</span><span class="nx">on</span> <span class="s">&#39;end&#39;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>        <span class="nx">callback</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">response</span>
</span><span class='line'>    <span class="k">if</span> <span class="nx">params</span>
</span><span class='line'>      <span class="nx">request</span><span class="p">.</span><span class="nx">write</span> <span class="nx">params</span>
</span><span class='line'>    <span class="nx">request</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.server = </span><span class="nx">server</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.get = </span><span class="nf">(url,params,callback) -&gt;</span>
</span><span class='line'>  <span class="k">if</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">2</span>
</span><span class='line'>    <span class="nv">callback = </span><span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>    <span class="nv">params = </span><span class="kc">null</span>
</span><span class='line'>  <span class="nx">makeRequest</span> <span class="nx">url</span><span class="p">,</span><span class="nx">params</span><span class="p">,</span><span class="s">&quot;GET&quot;</span><span class="p">,</span><span class="nx">callback</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.post = </span><span class="nf">(url,params,callback) -&gt;</span>
</span><span class='line'>  <span class="nx">makeRequest</span> <span class="nx">url</span><span class="p">,</span><span class="nx">params</span><span class="p">,</span><span class="s">&quot;POST&quot;</span><span class="p">,</span><span class="nx">callback</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>test_helpers.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">Sinon = </span><span class="nx">require</span> <span class="s">&quot;sinon&quot;</span>
</span><span class='line'><span class="nv">assert = </span><span class="nx">require</span> <span class="s">&quot;assert&quot;</span>
</span><span class='line'><span class="nv">http = </span><span class="nx">require</span> <span class="s">&quot;http&quot;</span>
</span><span class='line'><span class="nv">Model = </span><span class="nx">require</span> <span class="s">&quot;./model_helpers&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.spy = </span><span class="nf">(object,method) -&gt;</span>
</span><span class='line'>  <span class="nx">Sinon</span><span class="p">.</span><span class="nx">spy</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">method</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.stub = </span><span class="nf">(object, method, fn) -&gt;</span>
</span><span class='line'>  <span class="nx">Sinon</span><span class="p">.</span><span class="nx">stub</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">fn</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.spyRender = </span><span class="nf">-&gt;</span>
</span><span class='line'>  <span class="vi">@response = </span><span class="nx">http</span><span class="p">.</span><span class="nx">ServerResponse</span><span class="p">.</span><span class="nx">prototype</span>
</span><span class='line'>  <span class="nx">Sinon</span><span class="p">.</span><span class="nx">spy</span> <span class="nx">@response</span><span class="p">,</span> <span class="s">&quot;render&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.spyModel = </span><span class="nf">(klass,method) -&gt;</span>
</span><span class='line'>  <span class="nx">Sinon</span><span class="p">.</span><span class="nx">spy</span> <span class="p">(</span><span class="nx">Model</span><span class="p">.</span><span class="nx">getType</span> <span class="nx">klass</span><span class="p">),</span> <span class="nx">method</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.assert = </span><span class="nx">assert</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>model_helpers.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">mongoose = </span><span class="nx">require</span> <span class="s">&quot;mongoose&quot;</span>
</span><span class='line'><span class="nv">cleaner = </span><span class="k">new</span> <span class="p">(</span><span class="nx">require</span> <span class="s">&quot;database-cleaner&quot;</span><span class="p">)(</span><span class="s">&quot;mongodb&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.cleanupDB = </span><span class="nf">-&gt;</span>
</span><span class='line'>  <span class="nv">mongo = </span><span class="nx">mongoose</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">db</span>
</span><span class='line'>  <span class="nx">cleaner</span><span class="p">.</span><span class="nx">clean</span> <span class="nx">mongo</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.Factory = </span><span class="p">(</span><span class="nx">require</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/factories&quot;</span><span class="p">).</span><span class="nx">Factory</span>
</span><span class='line'>
</span><span class='line'><span class="nv">exports.getType = </span><span class="nf">(Klass) -&gt;</span>
</span><span class='line'>  <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span> <span class="nx">Klass</span>
</span></code></pre></td></tr></table></div></figure>


<p>My test logic dependencies are clean and encapsulated, making for both clearer
<code>require</code>s blocks and clearer tests themselves.</p>

<figure class='code'><figcaption><span>user_spec.coffee</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="p">{</span><span class="nx">Model</span><span class="p">,</span><span class="nx">Test</span><span class="p">,</span><span class="nx">Server</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&quot;../helpers&quot;</span>
</span><span class='line'><span class="nv">vows = </span><span class="nx">require</span> <span class="s">&#39;vows&#39;</span>
</span><span class='line'><span class="nv">User = </span><span class="nx">Model</span><span class="p">.</span><span class="nx">getType</span> <span class="s">&quot;User&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#code removed for brevity</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">addBatch</span>
</span><span class='line'>    <span class="s">&quot;Hashes password:&quot;</span><span class="o">:</span>
</span><span class='line'>      <span class="s">&quot;when a new user is created&quot;</span><span class="o">:</span>
</span><span class='line'>        <span class="nv">topic: </span><span class="nf">-&gt;</span>
</span><span class='line'>          <span class="vi">@user = </span><span class="nx">Model</span><span class="p">.</span><span class="nx">Factory</span><span class="p">.</span><span class="nx">build</span> <span class="s">&quot;User&quot;</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">spy</span> <span class="nx">User</span><span class="p">,</span> <span class="s">&quot;makeSalt&quot;</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">spy</span> <span class="nx">User</span><span class="p">,</span> <span class="s">&quot;hashPassword&quot;</span>
</span><span class='line'>          <span class="nx">@user</span><span class="p">.</span><span class="nx">save</span> <span class="nx">@callback</span>
</span><span class='line'>          <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>        <span class="s">&quot;it creates a salt and stores it&quot;</span><span class="o">:</span> <span class="nf">(err,user) -&gt;</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">User</span><span class="p">.</span><span class="nx">makeSalt</span><span class="p">.</span><span class="nx">calledOnce</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">user</span><span class="p">.</span><span class="nx">salt</span> <span class="o">==</span> <span class="nx">User</span><span class="p">.</span><span class="nx">makeSalt</span><span class="p">.</span><span class="nx">returnValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>        <span class="s">&quot;it encrpyts the password&quot;</span><span class="o">:</span> <span class="nf">(err,user) -&gt;</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">User</span><span class="p">.</span><span class="nx">hashPassword</span><span class="p">.</span><span class="nx">calledOnce</span>
</span><span class='line'>          <span class="nx">Test</span><span class="p">.</span><span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">User</span><span class="p">.</span><span class="nx">hashPassword</span><span class="p">.</span><span class="nx">calledWith</span> <span class="nx">@user</span><span class="p">.</span><span class="nx">password</span>
</span><span class='line'>
</span><span class='line'>      <span class="nv">teardown: </span><span class="nf">-&gt;</span>
</span><span class='line'>        <span class="nx">User</span><span class="p">.</span><span class="nx">hashPassword</span><span class="p">.</span><span class="nx">restore</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">User</span><span class="p">.</span><span class="nx">makeSalt</span><span class="p">.</span><span class="nx">restore</span><span class="p">()</span>
</span><span class='line'>        <span class="nx">Model</span><span class="p">.</span><span class="nx">cleanupDB</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/11/04/indie-productivity.html">Indie Productivity</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-11-04T14:25:00-07:00" pubdate data-updated="true">Nov 4<span>th</span>, 2011</time>
        
         | <a href="/2011/11/04/indie-productivity.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Being a contract web developer means working in a large number of enterprise
environments. While clients and projects vary dramatically, enterprise
environments almost always share certain characteristics in common: locked down
networks, limited use of open source libraries (and certainly no
contribution!), extreme caution regarding new technologies, and reliance on
libraries and tools which some might consider&hellip; deprecated. Most of these
characteristics are perfectly logical, given the complexity of enterprise
projects and the security required by legal considerations. Enterprise software
is frequently disregarded as sloppy, boring, uncreative, and poor &mdash; and I&rsquo;ve
certainly worked on these kinds of projects, and dealt with some
frustrating situations &mdash; but classifying <em>all</em> software in this way is unfair.
That said, even the best of enterprise projects feel constraining compared to
independent work.</p>

<p>Recent developments have certainly improvemed the enterprise work
environment. The proliferation of iOS devices has not only brought Macs into
the traditionally Windows-only world of the enterprise; it&rsquo;s brought a new
focus on standards-based webapps, which has forced
a reconsideration of existing technology stacks. As enterprises have adopted
dynamic languages and agile approaches &mdash; albeit slowly &mdash; they&rsquo;ve begun
upgrading their toolsets, as well. <a href="https://github.com/blog/978-introducing-github-enterprise">Github&rsquo;s announcement of an enterprise plan</a> demonstrates that it&rsquo;s starting to feel a little bit more
human within the confines of corporate intranets.</p>

<p>But even as the enterprise has evolved, the improvements made for individual
developer productivity have exploded. The ease with which a single developer
can build and deploy a scalable, cross-device, and revenue generating app is
beyond remarkable. The maturing of tools, languages, development environments,
and deployment strategies has created a fantastically productive environment.
To name a few favorites:</p>

<ul>
<li><p>Macbooks &ndash; The new Macbook Airs, when fully tricked out, offer incredibly
powerful development workhorses weighing less than 3 pounds and costing
less than $2k</p></li>
<li><p><a href="http://mxcl.github.com/homebrew/">Homebrew</a> &ndash; A package manager for Mac OS,
making that Macbook purchase perfect</p></li>
<li><p><a href="http://heroku.com">Heroku</a> &ndash; Have an idea for a new project? Deploy it for
free. Want to scale it? Flip a switch</p></li>
<li><p><a href="http://www.opscode.com/chef/">Chef</a> and <a href="http://puppetlabs.com/">Puppet</a> &ndash; Want
more control than Heroku offers? Fine, manage your own boxes with
a sane devops solution that you can take with you.</p></li>
<li><p>Git and <a href="http://github.com">Github</a> &ndash; Who could have ever imagined that
managing code could be so enjoyable?</p></li>
<li><p>zsh and <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a> &ndash; Tab completion, customizable plugins, persistent Git HUD</p></li>
<li><p>The incredible profusion of programming languages, libraries, and frameworks &ndash; <a href="http://scala-lang.org">Scala</a>,
<a href="http://clojure.org">Clojure</a>,
<a href="http://nodejs.org">node.js</a>, the <a href="http://www.playframework.org/">Play framework</a>, NoSql solutions,
nginx, to say nothing of the maturing of Ruby (especially Rails) and Python &ndash; all of
these technologies make it easier than ever to work in one&rsquo;s preferred
style without sacrificing power or performance. The communities around each
of these technologies, empowered by twitter, StackExchange, and Github,
ease learning curves and offer helpful answers to any questions.</p></li>
<li><p>The Apple App store, <a href="https://squareup.com/">Square</a>, <a href="http://stripe.com">Stripe</a>, <a href="http://recurly.com/">Recurly</a>,
and <a href="https://samurai.feefighters.com/">Samurai</a> enable developers to make money on their ideas and apps
with far less effort than in the past.</p></li>
</ul>


<p>Is there <em>any other industry</em> in which an individual has such a <em>dramatic</em>
advantage in tools, cost, and agility over large organizations?</p>

<p>It&rsquo;s an exciting time for indie developers. And the future keeps looking better.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/09/13/back-from-vacation.html">Back From Vacation</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-09-13T00:00:00-07:00" pubdate data-updated="true">Sep 13<span>th</span>, 2011</time>
        
         | <a href="/2011/09/13/back-from-vacation.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just returned from a fantastic vacation to London and Copenhagen. I&rsquo;d visited
London, before but had never been to Copenhagen, or any Scandinavian country.
As an engineer, I could barely wrap my mind around the brilliant efficiencies
of the city. The train system is a wonder &ndash; incredibly efficient, clean,and
comprehensive, with the ability to get anywhere easily, and even allowing sales
of travel tickets via text message. My heart warmed at the first site of
a flotilla of bike-commuters sailing by on our walk to our hotel. The Danes
themselves consistently impressed us with their warmth and hospitality. I look
forward to returning soon.</p>

<p>My brain is struggling to return to coding productivity after its extended
vacation, so I&rsquo;ve mostly been reviewing my RSS reader to aid in the transition.
Assaf Arkin, to whom I owe a massive debt for his creation of <a href="http://zombie.labnotes.org/">Node testingtool Zombie.js</a>,
wrote a <a href="http://labnotes.org/2011/09/06/what-self-can-teach-us-about-the-future-of-javascript/">great article on Self</a>
that deserves mentioning. Self, as most JS developers know, played an important
role in inspiring Brendan Eich&rsquo;s creation of Javascript, but I was unaware of
the details of the language.</p>

<p>Assaf&rsquo;s whole article is worth reading, but one particular quote stood out:</p>

<blockquote><p>language and environment come together to achieve a common goal: to create an environment that is malleable,
that allows learning through sharing and exploration,
that uses minimalism and consistency to foster reuse.</p></blockquote>

<p>Minimalism, consistency, malleability.</p>

<p>These words work not just as signposts of good language design, but of everything from
API construction to individual units of code. I&rsquo;m certainly planning on using them
as my mantra as I slowly get back up to speed with work.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/08/16/introducing-vows-bdd.html">Introducing Vows-bdd</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-08-16T00:00:00-07:00" pubdate data-updated="true">Aug 16<span>th</span>, 2011</time>
        
         | <a href="/2011/08/16/introducing-vows-bdd.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My work with Node.js has recently transformed from the occassional experiment to
the building of a full-on side project. It&rsquo;s fascinating to be working with a set
of tools that are so rapidly developing; the energy and excitement in the Node
ecosystem far outweighs any annoyances with needing to adjust to changing APIs.</p>

<h3>Embracing Vows</h3>

<p>One of the tools which I&rsquo;ve really enjoyed learning is <a href="http://vowsjs.org">Vows.js</a>.
Vows.js is a fully async Javascript testing library that allows for blazingly fast
execution. (It&rsquo;s amazing how little changes in test speed can make TDD feel
much less onerous.)  Vows&#8217; syntax can be a little tough to adjust to, but the speed,
combined with the ability to construct &ldquo;test batches&rdquo;, make the barrier to entry
worth the effort.</p>

<p>While Vows is a near pefect tool for unit testing, I began to run into trouble with
full-stack integration testing. Check out the contrived example below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">vows</span><span class="p">.</span><span class="nx">describe</span><span class="p">(</span><span class="s">&quot;Creating a User&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">addBatch</span>
</span><span class='line'>    <span class="s">&quot;To create a user&quot;</span><span class="o">:</span>
</span><span class='line'>
</span><span class='line'>      <span class="s">&quot;Given the server has started&quot;</span><span class="o">:</span>
</span><span class='line'>        <span class="nv">topic:</span>
</span><span class='line'>          <span class="nx">server</span><span class="p">.</span><span class="nx">ready</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>        <span class="s">&quot;and the DB is populated&quot;</span><span class="o">:</span>
</span><span class='line'>          <span class="nv">topic:</span>
</span><span class='line'>            <span class="nx">setupFixtures</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>          <span class="s">&quot;and another setup function is required&quot;</span><span class="o">:</span>
</span><span class='line'>            <span class="nv">topic: </span><span class="nf">-&gt;</span>
</span><span class='line'>              <span class="nx">anotherSetup</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>            <span class="s">&quot;When visiting the form at /user/new&quot;</span><span class="o">:</span>
</span><span class='line'>              <span class="nv">topic: </span><span class="nf">-&gt;</span>
</span><span class='line'>                <span class="nv">ctx = </span><span class="k">this</span>
</span><span class='line'>                <span class="nx">server</span><span class="p">.</span><span class="nx">ready</span> <span class="nf">-&gt;</span>
</span><span class='line'>                  <span class="nx">zombie</span><span class="p">.</span><span class="nx">visit</span> <span class="s">&quot;http://localhost:</span><span class="si">#{</span><span class="nx">port</span><span class="si">}</span><span class="s">/user/new&quot;</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">callback</span>
</span><span class='line'>                <span class="k">return</span>
</span><span class='line'>
</span><span class='line'>              <span class="s">&quot;then should allow entry of a username&quot;</span><span class="o">:</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>                <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=username]&quot;</span>
</span><span class='line'>
</span><span class='line'>              <span class="s">&quot;should allow entry of first and last name&quot;</span><span class="o">:</span> <span class="nf">(err,b,s) -&gt;</span>
</span><span class='line'>                <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">b</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=firstName]&quot;</span>
</span><span class='line'>                <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">b</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=lastName]&quot;</span>
</span><span class='line'>
</span><span class='line'>              <span class="s">&quot;should allow entry of a password&quot;</span><span class="o">:</span> <span class="nf">(err,b,s) -&gt;</span>
</span><span class='line'>                <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">b</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=password]&quot;</span>
</span><span class='line'>
</span><span class='line'>              <span class="s">&quot;should allow confirmation of a password&quot;</span><span class="o">:</span> <span class="nf">(err,b,s) -&gt;</span>
</span><span class='line'>                <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">b</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=passwordConfirm]&quot;</span>
</span><span class='line'>
</span><span class='line'>              <span class="s">&quot;and submitting the form&quot;</span><span class="o">:</span>
</span><span class='line'>                <span class="nv">topic: </span><span class="nf">(browser,status) -&gt;</span>
</span><span class='line'>                  <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;firstName&quot;</span><span class="p">,</span> <span class="s">&quot;Justin&quot;</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;lastName&quot;</span><span class="p">,</span> <span class="s">&quot;Reidy&quot;</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Sign Up!&quot;</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>                <span class="s">&quot;should create a new User&quot;</span><span class="o">:</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>                  <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">findNewUser</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">.</span><span class="nx">export</span> <span class="nx">module</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ouch. All that nesting makes for pretty unreadable code &ndash; even in CoffeeScript.</p>

<h3>vows-bdd: an easier way to test</h3>

<p>I&rsquo;ve never been a huge Cucumber fan, but modeling integration tests in a &ldquo;given-when
-then&rdquo; format makes them much easier for me to construct mentally. While the
<a href="https://github.com/jadell/prenup">prenup</a> library made long Vows tests easier to read by introducing a
fluent interface, I thought that I&rsquo;d love to marry this fluent approach with BDD&rsquo;s
&ldquo;given-when-then&rdquo;.</p>

<p>A couple days later and vows-bdd was born:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nx">Feature</span><span class="p">(</span><span class="s">&quot;Creating a User&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">scenario</span><span class="p">(</span><span class="s">&quot;Create a User via Form&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">given</span> <span class="s">&quot;the server is running&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">server</span><span class="p">.</span><span class="nx">ready</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="o">and</span> <span class="s">&quot;the DB is popuplated&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">setupFixtures</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="o">and</span> <span class="s">&quot;another setup function is called&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">anotherSetup</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I visit the form at user/new&quot;</span><span class="p">,</span> <span class="nf">-&gt;</span>
</span><span class='line'>    <span class="nx">zombie</span><span class="p">.</span><span class="nx">visit</span> <span class="s">&quot;http://localhost:</span><span class="si">#{</span><span class="nx">port</span><span class="si">}</span><span class="s">/user/new&quot;</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span> <span class="s">&quot;I should see a username field&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=username]&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="o">and</span> <span class="s">&quot;I should see entries for first and last name&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=firstName]&quot;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span> <span class="s">&quot;:input[name=lastName]&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="o">and</span> <span class="s">&quot;I should see a password entry&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">,</span> <span class="s">&quot;:input[name=password]&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="o">and</span> <span class="s">&quot;I should see a password confirmation&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">,</span> <span class="s">&quot;:input[name=passwordConfirm]&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">when</span> <span class="s">&quot;I submit the form&quot;</span><span class="p">,</span> <span class="nf">(browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">browser</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">,</span> <span class="s">&quot;test&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;firstName&quot;</span><span class="p">,</span> <span class="s">&quot;Justin&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;lastName&quot;</span><span class="p">,</span> <span class="s">&quot;Reidy&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="s">&quot;foobar&quot;</span><span class="p">)</span>
</span><span class='line'>           <span class="p">.</span><span class="nx">pressButton</span> <span class="s">&quot;Sign Up!&quot;</span><span class="p">,</span> <span class="nx">@callback</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">then</span> <span class="s">&quot;a new User should be created&quot;</span><span class="p">,</span> <span class="nf">(err,browser,status) -&gt;</span>
</span><span class='line'>    <span class="nx">assert</span><span class="p">.</span><span class="nx">ok</span> <span class="nx">findNewUser</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
</span><span class='line'>  <span class="p">.</span><span class="nx">finish</span><span class="p">(</span><span class="nx">module</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Checkout the <a href="https://github.com/jmreidy/vows-bdd">repo on Github</a>
for more documentation and info.</p>

<h3>Open-Source is scary!</h3>

<p>The vast majority of my career has taken place in enterprise world, where code is
rarely, if ever, shared with anyone on the outside, and even <em>using</em> open-source
code is considered dangerous. While I&rsquo;ve contributed to OSS libraries
before, I&rsquo;ve never posted my own creation. It&rsquo;s fairly nerve-wracking to put your
work out in the wild, especially when you&rsquo;re building on top of such amazing
contributions from incredible developers.</p>

<p>In fact, I probably would&rsquo;ve sat on this little library forever, constantly trying
to perfect it, if not for a
<a href="http://blog.nodejitsu.com/the-nodejs-philosophy">fantastic blog post</a>
written by Charlie Robbins(<a href="http://twitter.com/indexzero">@indexzero</a>)
over at Nodejitsu. I think his post perfectly expresses the spirt and mentality
of the Node community right now,
and his emphasis on experimentation via small bits of functionality made me realize:
this code may not be perfect, and it might not even do that much, but if <em>I</em> find it
useful, then maybe someone else will too.</p>

<p>So please &ndash; <a href="https://github.com/jmreidy/vows-bdd">checkout vows-bdd</a> and give it a whirl.
Any suggestions or comments would be very much appreciated!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/2011/07/08/this-in-anonymous-functions.html">&#8220;This&#8221; in Anonymous Functions</a></h1>
      
      
    
      <p class="meta">
        








  


<time datetime="2011-07-08T00:00:00-07:00" pubdate data-updated="true">Jul 8<span>th</span>, 2011</time>
        
         | <a href="/2011/07/08/this-in-anonymous-functions.html#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sometimes it&rsquo;s difficult to find an easy answer to common coding questions. Because
Google ignores most punctuation, even the most exact queries fail to produce
relevant results. Questions about the nature and value of <code>this</code> in Javascript present
a particularly thorny problem, since &ldquo;this&rdquo; is about as common a word as you can find.</p>

<p>A common point of confusion in Javascript is that the value of <code>this</code> depends entirely
on a function&rsquo;s context, and can even be overridden depending on how a function is
invoked. Hopefully this post will save time for new Javascript devs trolling through
Google&rsquo;s depths:</p>

<blockquote><p>In anonymous functions, the value of <code>this</code> refers to the anonymous function itself,
and not the calling scope. However, the nature of closures allows the anonymous function
to still refer to the calling object.</p></blockquote>

<p>The above rule is demonstrated with the following nodejs code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'><span class="nx">that</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">process</span><span class="p">.</span><span class="nx">nextTick</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;this &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">+</span> <span class="s2">&quot; and that &quot;</span> <span class="o">+</span> <span class="nx">that</span><span class="p">.</span><span class="nx">foo</span><span class="p">)</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>A little something about me.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/07/02/private-github-repos-with-npm-and-heroku.html">Private Github Repos with NPM &amp; Heroku</a>
      </li>
    
      <li class="post">
        <a href="/2013/04/11/in-theory-not-practice.html">In Theory, Not Practice</a>
      </li>
    
      <li class="post">
        <a href="/2013/04/02/towards-a-unified-js-stack.html">Towards a Unified JS Stack</a>
      </li>
    
      <li class="post">
        <a href="/2012/10/01/error-isolation-with-promises.html">Error Isolation with Promises</a>
      </li>
    
      <li class="post">
        <a href="/2012/08/01/client-side-testing-insanity.html">Client-Side Testing Insanity</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/jmreidy">@jmreidy</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jmreidy',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Justin Reidy <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'razorsharp';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
